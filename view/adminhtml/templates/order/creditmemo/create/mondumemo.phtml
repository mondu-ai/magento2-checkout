<?php

declare(strict_types=1);

/**
 * @var \Magento\Framework\Escaper $escaper
 * @var \Mondu\Mondu\Block\Memo $block
 */
$invoices = $block->invoices();
$mapping = $block->getInvoiceMappings();
?>

<?php if ($block->render()): ?>
<div class="field choice admin__field">
    <?= $escaper->escapeHtml($block->getPaymentMethod()) ?>
    <div class="admin__field">
        <label class="admin__field-label" for="history_status">Invoice to memo</label>
        <div class="admin__field-control">
            <select class="admin__control-select" id="history_status" name="creditmemo[creditmemo_mondu_id]">
                <?php $i = 0; foreach ($mapping as $key => $item): ?>
                    <option value="<?= $escaper->escapeHtml($item['uuid']) ?>"
                        <?php
                            (isset($item['state']) && $item['state'] === 'complete')
                                ? $escaper->escapeHtml('disabled')
                                : ''
                        ?>
                    >
                        INVOICE: <?= $escaper->escapeHtml($key) ?> State: <?= $escaper->escapeHtml($item['state']) ?>
                    </option>
                <?php endforeach; ?>
            </select>
        </div>
    </div>
</div>
<?php endif; ?>
